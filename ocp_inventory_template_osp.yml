---
  - name: Generate Openshift Container Platform installer inventory file

    hosts: bastion
    gather_facts: no

    vars:
      template: 'inventory-glusterfs.j2' 
      
      OCP_MASTERS: ['master.ocpcloud.local']
      OCP_INFRA_NODES: ['infra1.ocpcloud.local', 'infra2.ocpcloud.local', 'infra3.ocpcloud.local']
      OCP_APP_NODES: 
        - { host: 'appnode1.ocpcloud.local', region: 'dev' }
        - { host: 'appnode2.ocpcloud.local', region: 'dev' }
        - { host: 'appnode3.ocpcloud.local', region: 'test' }
      LB: "no"
      OCP_LB_NODES:
      #if you set CNS="yes" you need to specify 3 infra nodes and 3 app nodes above
      CNS: "no"
      
      OCP_SSH_USER: cloud-user
      OCP_SSH_BECOME: true
      
      OCP_IPA: "yes"
      OCP_IPA_HOSTNAME: ipa.ocpcloud.local
      OCP_IPA_DOMAIN: dc=ocpcloud,dc=local
      OCP_IPA_PASSWORD: "{{ lookup('env','IPA_PASSWORD') }}"
    
      OCP_DEFAULT_SUBDOMAIN: cloudapps.ocpcloud.local
      OCP_MASTER_HOSTNAME: master.ocpcloud.local
      OCP_MASTER_PUBLIC_HOSTNAME: master.ocpcloud.com

      OCP_SERVICE_CATALOG: "yes" 
   
      HTTP_PROXY: "no"
      OCP_HTTP_PROXY:
      OCP_HTTPS_PROXY: 
      OCP_NO_PROXY:

      AWS: "no"
      
      OSP: "yes"
      OSP_AUTH_URL: "{{ lookup('env','OSP_AUTH_URL') }}"
      OSP_USERNAME: "{{ lookup('env','OSP_USERNAME') }}"
      OSP_PASSWORD: "{{ lookup('env','OSP_PASSWORD') }}"
      OSP_TENANT_ID: "{{ lookup('env','OSP_TENANT_ID') }}"
      OSP_TENANT_NAME: "{{ lookup('env','OSP_TENANT_NAME') }}"
      OSP_REGION: "{{ lookup('env','OSP_REGION') }}"
      OSP_DOMAIN_ID: "{{ lookup('env','OSP_DOMAIN_ID') }}"
      OSP_DOMAIN_NAME: "{{ lookup('env','OSP_DOMAIN_NAME') }}" 
  
    tasks:
      - name: Proces inventory template file
        template:
          src: "{{ template }}"
          dest: ./inventory

