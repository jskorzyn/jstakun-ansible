---
  - name: Prepare RHEL server to install Openshift Container Platform
  
    hosts: nodes
    become: true
    gather_facts: no

    vars:
  
    vars_prompt:
      - name: "rhn_username" 
        prompt: "Enter your Red Hat Network username"
        private: no

      - name: "rhn_password"
        prompt: "Enter your Red Hat Network password"
        private: yes

      - name: "pool"
        prompt: "Enter Red Hat Network subscription pool id"
        private: no
    
      #- name: "hostname"
      #  prompt: "Enter hostname"
     
    tasks:  
      #- name: 'Set hostname'
      #  command: 'hostnamectl set-hostname {{ hostname }}'

      #- name: 'Login to RHN and assign RHN pool'
      #  redhat_subscription: 
      #     state: present 
      #     username: "{{ rhn_username }}" 
      #     password: "{{ rhn_password }}"
      #     pool_ids: "{{ pool  }}"

      #- name: 'Disable local repos'
      #  command: "yum-config-manager --disable *" 

      #- name: 'Enable required RHN repos'
      #  command: "subscription-manager repos --disable=* --enable=rhel-7-server-rpms --enable=rhel-7-server-extras-rpms --enable=rhel-7-server-ose-3.6-rpms"

      #- name: 'Enable CNS repo'
      #  command: "subscription-manager repos --enable=rh-gluster-3-for-rhel-7-server-rpms"

      #- name: 'Yum install required packages'
      #  yum:
      #     name: 'net-tools bind-utils iptables-services bridge-utils bash-completion kexec-tools sos psacct'
      #     state: latest

      #- name: 'Yum update all'
      #  yum:
      #      name: '*' 
      #      state: latest

      - name: 'Yum install atomic openshift utils'
        yum: 
           name: atomic-openshift-utils 
           state: latest

      - name: 'Yum install glusterfs fuse'
        yum:
           name: glusterfs-fuse
           state: latest
   
      #- name: 'Yum install docker'
      #  yum: 
      #    name: docker 
      #    state: latest

      #- name: 'Edit docker config file'
      #  lineinfile:
      #    dest: /etc/sysconfig/docker
      #    regexp: "^OPTIONS='--selinux-enabled'"
      #    line: "OPTIONS='--selinux-enabled --insecure-registry 172.30.0.0/16'"

      #- name: 'Restart docker service'
      #  service: 
      #    name: docker 
      #    state: restarted

